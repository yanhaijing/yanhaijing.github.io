---
layout: post
title: å¦‚ä½•åœ¨ JavaScript ä¸­åˆ¤æ–­ä¸¤ä¸ªå€¼ç›¸ç­‰
category: javascript
tagline: 'åŸåˆ›'
tags: [javascript, é¢è¯•çŸ¥è¯†]
keywords: [javascript]
description:
---

{% include JB/setup %}

> æœ¬æ–‡å·²æ”¶å½•åˆ°ã€Š[é¢è¯•çŸ¥è¯†ç³»åˆ—](https://yanhaijing.com/tags/#%E9%9D%A2%E8%AF%95%E7%9F%A5%E8%AF%86-ref)ã€‹

åœ¨ JavaScript ä¸­å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªå€¼ç›¸ç­‰ï¼Œè¿™ä¸ªé—®é¢˜çœ‹èµ·æ¥éå¸¸ç®€å•ï¼Œä½†å¹¶éå¦‚æ­¤ï¼Œåœ¨ JavaScript ä¸­å­˜åœ¨ 4 ç§ä¸åŒçš„ç›¸ç­‰é€»è¾‘ï¼Œå¦‚æœä½ ä¸çŸ¥é“ä»–ä»¬çš„åŒºåˆ«ï¼Œæˆ–è€…è®¤ä¸ºåˆ¤æ–­ç›¸ç­‰éå¸¸ç®€å•ï¼Œé‚£ä¹ˆæœ¬æ–‡éå¸¸é€‚åˆä½ é˜…è¯»ã€‚

ECMAScript æ˜¯ JavaScript çš„è¯­è¨€è§„èŒƒï¼Œåœ¨[ECMAScript è§„èŒƒ](https://262.ecma-international.org/8.0/#sec-samevalue)ä¸­å­˜åœ¨å››ç§ç›¸ç­‰ç®—æ³•ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![]({{BLOG_IMG}}590.png)

ä¸Šå›¾ä¸­å››ç§ç®—æ³•å¯¹åº”çš„ä¸­æ–‡åå­—å¦‚ä¸‹ï¼Œå¤§éƒ¨åˆ†å‰ç«¯åº”è¯¥ç†Ÿæ‚‰ä¸¥æ ¼ç›¸ç­‰å’Œéä¸¥æ ¼ç›¸ç­‰ï¼Œä½†å¯¹äºåŒå€¼é›¶å’ŒåŒå€¼å´ä¸ç†Ÿæ‚‰ï¼Œä¸‹é¢æˆ‘ä»¬åˆ†åˆ«ä»‹ç»è¿™å››ç§ç®—æ³•ã€‚

- åŒå€¼
- åŒå€¼é›¶
- éä¸¥æ ¼ç›¸ç­‰
- ä¸¥æ ¼ç›¸ç­‰

### éä¸¥æ ¼ç›¸ç­‰

éä¸¥æ ¼ç›¸ç­‰ä½¿ç”¨ä¸¤ä¸ªç­‰å·ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„åŒç­‰ï¼Œéä¸¥æ ¼ç›¸ç­‰è¡¨ç¤ºè¯­ä¹‰ç›¸ç­‰ï¼Œä¸è¦æ±‚ç±»å‹ä¸€æ ·ï¼Œéä¸¥æ ¼ç›¸ç­‰åœ¨æ¯”è¾ƒå‰ä¼šå…ˆå°†æ¯”è¾ƒå‚æ•°ç±»å‹è½¬æ¢ä¸ºä¸€è‡´ï¼Œå†è¿›è¡Œæ¯”è¾ƒï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

```js
1 == 1; // true
1 == '1'; // true ç±»å‹ä¸åŒï¼Œä¸å½±å“æ¯”è¾ƒç»“æœ
```

éä¸¥æ ¼ç›¸ç­‰æœ‰éå¸¸å¤æ‚çš„è½¬æ¢è§„åˆ™ï¼Œéå¸¸éš¾ä»¥è®°å¿†ï¼Œç¤¾åŒºä¸­[æœ‰äºº](https://dorey.github.io/JavaScript-Equality-Table/)å°†ä¸Šé¢çš„è§„åˆ™æ€»ç»“æˆäº†å›¾ç‰‡ï¼Œä¸€å›¾èƒœåƒè¨€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![]({{BLOG_IMG}}591.png)

ä¸ºäº†æ–¹ä¾¿è®°ä½éä¸¥æ ¼ç›¸ç­‰çš„çš„è½¬æ¢é€»è¾‘ï¼Œä½œè€…å°†éå¯¹è±¡å€¼ï¼Œå¯ä»¥æ€»ç»“ä¸ºå¦‚ä¸‹ä¸‰æ¡è§„åˆ™ï¼š

- Undefined åªå’Œ Null ç›¸ç­‰
- å’Œ Number æ¯”è¾ƒæ—¶ï¼Œå¦ä¸€ä¸ªå€¼ä¼šè‡ªåŠ¨è½¬æ¢ä¸º Number
- å’Œ Boolean æ¯”è¾ƒæ—¶ï¼Œå¦ä¸€ä¸ªå€¼ä¼šè½¬æ¢ä¸º Number

å¦‚æœå€¼ä¸ºå¯¹è±¡ï¼Œä¼šä½¿ç”¨å†…éƒ¨çš„ ToPrimitive è½¬æ¢ï¼Œå¯ä»¥é€šè¿‡è‡ªå®šä¹‰ Symbol.toPrimitive æ”¹å˜è¿”å›å€¼ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯åœ¨ç›¸ç­‰çš„åˆ¤æ–­ä¸­ Symbol.toPrimitive æ¥å—çš„ hint å‚æ•°éƒ½æ˜¯ defaultã€‚

```js
const obj = {
  [Symbol.toPrimitive](hint) {
    console.log(hint);
    if (hint == 'number') {
      return 1;
    }
    if (hint == 'string') {
      return 'yan';
    }
    return true;
  },
};

console.log(obj == 1); // obj è¿”å› true
console.log(obj == '1'); // obj è¿”å› true
console.log(obj == true); // obj è¿”å› true
```

éä¸¥æ ¼ç›¸ç­‰å¹¶éå¸¦æ¥äº†å¾ˆå¤šä¾¿åˆ©ï¼Œé€šè¿‡éšå¼çš„è‡ªåŠ¨è½¬æ¢ï¼Œç®€åŒ–äº†éƒ¨åˆ†åœºæ™¯çš„å·¥ä½œï¼Œæ¯”å¦‚ Number å’Œ String çš„è‡ªåŠ¨è½¬æ¢ï¼Œç®€åŒ–äº†å‰ç«¯ä»è¡¨å•ï¼Œurl å‚æ•°ä¸­è·å–å€¼çš„æ¯”è¾ƒé—®é¢˜ï¼Œä½†è‡ªåŠ¨è½¬æ¢å¸¦æ¥çš„é—®é¢˜æ¯”ä¾¿åˆ©è¿˜å¤šã€‚

éšå¼è½¬æ¢çš„è§„åˆ™ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹éš¾ä»¥é©¾é©­ï¼Œç°åœ¨ä¸»æµçš„è§‚ç‚¹å·²ç»ä¸å»ºè®®ä½¿ç”¨ï¼Œä½œè€…å»ºè®®åªåœ¨åˆ¤æ–­ undefined å’Œ null çš„åœºæ™¯ä¸‹å¯ä»¥ä½¿ç”¨éä¸¥æ ¼ç›¸ç­‰ã€‚

## ä¸¥æ ¼ç›¸ç­‰

ä¸¥æ ¼ç›¸ç­‰æ˜¯å¦ä¸€ç§æ¯”è¾ƒç®—æ³•ï¼Œå…¶å’Œéä¸¥æ ¼æƒ³ç­‰çš„åŒºåˆ«æ˜¯ä¸ä¼šè¿›è¡Œç±»å‹è½¬æ¢ï¼Œç±»å‹ä¸ä¸€è‡´æ—¶ç›´æ¥è¿”å› falseï¼Œä¸¥æ ¼ç›¸ç­‰å¯¹åº”===æ“ä½œç¬¦ï¼Œå› ä¸ºä½¿ç”¨ä¸‰ä¸ªç­‰å·ï¼Œä¹Ÿè¢«ç§°ä½œä¸‰ç­‰æˆ–è€…å…¨ç­‰ï¼Œä¸¥æ ¼ç›¸ç­‰ç¤ºä¾‹å¦‚ä¸‹ï¼š

```js
1 === 1; // true
1 === '1'; // false ç±»å‹ä¸åŒï¼Œå½±å“æ¯”è¾ƒç»“æœ
```

ä¸åŒç±»å‹å€¼åˆ¤æ–­è§„åˆ™å¦‚ä¸‹ï¼Œå’Œå‰é¢çš„éä¸¥æ ¼ç›¸ç­‰å¯¹æ¯”ï¼Œä¸¥æ ¼ç›¸ç­‰æ›´ç¬¦åˆç›´è§‰ã€‚

![]({{BLOG_IMG}}592.png)

ä¸¥æ ¼ç›¸ç­‰è§£å†³äº†éä¸¥æ ¼ç›¸ç­‰ä¸­éšå¼è½¬æ¢å¸¦æ¥çš„é—®é¢˜ï¼Œä½†ä¹Ÿä¸¢å¤±äº†éšå¼è½¬æ¢å¸¦æ¥çš„ä¾¿åˆ©ï¼Œå¯¹äºç±»å‹å¯èƒ½ä¸ä¸€è‡´çš„æƒ…å†µä¸‹ï¼Œæ¯”å¦‚ä»è¡¨å•ä¸­è·å–çš„å€¼éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œä¿é™©çš„åšæ³•æ˜¯ï¼Œåœ¨æ¯”è¾ƒå‰æ‰‹åŠ¨ç±»å‹è½¬æ¢ï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

```js
1 === Number('1'); // true æ‰‹åŠ¨ç±»å‹è½¬æ¢ï¼Œç±»å‹é˜²å¾¡
```

ä¸¥æ ¼ç›¸ç­‰å‡ ä¹æ€»æ˜¯æ­£ç¡®çš„ï¼Œä½†ä¹Ÿæœ‰ä¾‹å¤–æƒ…å†µï¼Œæ¯”å¦‚ NaN å’Œæ­£è´Ÿ 0 çš„é—®é¢˜ã€‚

Number ç±»å‹æœ‰ä¸ªç‰¹æ®Šçš„å€¼ NaNï¼Œç”¨æ¥è¡¨ç¤ºè®¡ç®—é”™è¯¯çš„æƒ…æ¦‚å†µï¼Œæ¯”è¾ƒå¸¸è§æ˜¯é Number ç±»å‹å’Œ Number ç±»å‹è®¡ç®—æ—¶ï¼Œä¼šå¾—åˆ° NaN å€¼ï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼Œè¿™æ˜¯ä»è¡¨å•å’Œæ¥å£è¯·æ±‚è·å–æ•°æ®æ—¶å¾ˆå®¹æ˜“å‡ºç°çš„é—®é¢˜ã€‚

```js
const a = 0 / 0; // NaN
const b = 'a' / 1;
const c = undefined + 1; // NaN
```

åœ¨ä¸¥æ ¼ç›¸ç­‰ä¸­ï¼ŒNaN æ˜¯ä¸ç­‰äºè‡ªå·±çš„ï¼ŒNaN æ˜¯(x !== x) æˆç«‹çš„å”¯ä¸€æƒ…å†µï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹å…¶å®æ˜¯å¸Œæœ›èƒ½å¤Ÿåˆ¤æ–­ NaN çš„ï¼Œå¯ä»¥ä½¿ç”¨ isNaN è¿›è¡Œåˆ¤æ–­ï¼ŒECMAScript 2015 å¼•å…¥äº†æ–°çš„ Number.isNaNï¼Œå’Œ isNaN çš„åŒºåˆ«æ˜¯ä¸ä¼šå¯¹ä¼ å…¥çš„å‚æ•°åšç±»å‹è½¬æ¢ï¼Œå»ºè®®ä½¿ç”¨è¯­ä¹‰æ›´æ¸…æ™°çš„ Number.isNaNï¼Œä½†æ˜¯è¦æ³¨æ„å…¼å®¹æ€§é—®é¢˜ï¼Œåˆ¤æ–­ NaN ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

```js
NaN === NaN; // false

isNaN(NaN); // true
Number.isNaN(NaN); // true

isNaN('aaa'); // true è‡ªåŠ¨è½¬æ¢ç±»å‹ 'aaa'è½¬æ¢ä¸ºNumberä¸ºNaN
Number.isNaN('aaa'); // false ä¸è¿›è¡Œè½¬æ¢ï¼Œç±»å‹ä¸ä¸ºNumberï¼Œç›´æ¥è¿”å›false
```

ä¸¥æ ¼ç›¸ç­‰å¦ä¸€ä¸ªä¾‹å¤–æƒ…å†µæ˜¯ï¼Œæ— æ³•åŒºåˆ†+0 å’Œ-0ï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼Œåœ¨ä¸€äº›æ•°å­¦è®¡ç®—åœºæ™¯ä¸­æ˜¯è¦åŒºåˆ†è¯­ä¹‰çš„ã€‚

```js
+0 === -0; // true
```

JavaScript ä¸­å¾ˆå¤šç³»ç»Ÿå‡½æ•°éƒ½ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰ï¼Œæ¯”å¦‚æ•°ç»„çš„ indexOfï¼ŒlastIndexOf å’Œ switch-case ç­‰ï¼Œéœ€è¦æ³¨æ„ï¼Œè¿™äº›å¯¹äº NaN æ— æ³•è¿”å›æ­£ç¡®ç»“æœï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

```js
[NaN].indexOf(NaN); // -1 æ•°ç»„ä¸­å…¶å®å­˜åœ¨NaN
[NaN].lastIndexOf(NaN); // -1
```

## åŒå€¼é›¶

åŒå€¼é›¶æ˜¯å¦ä¸€ç§ç›¸ç­‰ç®—æ³•ï¼Œåå­—æ¥æºäºè§„èŒƒçš„ç›´è¯‘ï¼Œè§„èŒƒä¸­å«åš SameValueZeroï¼ŒåŒå€¼é›¶å’Œä¸¥æ ¼ç›¸ç­‰åŠŸèƒ½ä¸€æ ·ï¼Œé™¤äº†å¤„ç† NaN çš„æ–¹å¼ï¼ŒåŒå€¼é›¶è®¤ä¸º NaN å’Œ NaN ç›¸ç­‰ï¼Œè¿™åœ¨åˆ¤æ–­ NaN æ˜¯å¦åœ¨é›†åˆä¸­çš„è¯­ä¹‰ä¸‹æ˜¯éå¸¸åˆç†çš„ã€‚

ECMAScript 2016 å¼•å…¥çš„ includes ä½¿ç”¨æ­¤ç®—æ³•ï¼Œæ­¤å¤– Map çš„é”®å»é‡å’Œ Set çš„å€¼å»é‡ï¼Œä½¿ç”¨æ­¤ç®—æ³•ï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

```js
[NaN].incdudes(NaN); // true æ³¨æ„å’ŒindexOfçš„åŒºåˆ«ï¼Œincdudesçš„è¯­ä¹‰æ›´åˆç†

new Set([NaN, NaN]); // [NaN] setä¸­åªä¼šæœ‰ä¸ªä¸€ä¸ªNaNï¼Œå¦‚æœ NaN !== NaNçš„è¯ï¼Œåº”è¯¥æ˜¯[NaN, NaN]

new Map([
  [NaN, 1],
  [NaN, 2],
]); // {NaN => 2} å¦‚æœ NaN !== NaNçš„è¯ï¼Œåº”è¯¥æ˜¯ {NaN => 1, NaN => 2}
```

## åŒå€¼

åŒå€¼æ˜¯æœ€åä¸€ç§ç›¸ç­‰ç®—æ³•ï¼Œå…¶å’ŒåŒå€¼é›¶ç±»ä¼¼ï¼Œä½†è®¤ä¸º +0 ä¸ç­‰äº -0ï¼ŒECMAScript 2015 å¸¦æ¥çš„ Object.is ä½¿ç”¨åŒå€¼ç®—æ³•ï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

```js
Object.is(NaN, NaN); // true
Object.is(+0, -0); // false ğŸ“¢ æ³¨æ„è¿™é‡Œ
```

åŒå€¼ç®—æ³•çš„ä½¿ç”¨åœºæ™¯æ˜¯ï¼Œç¡®å®šä¸¤ä¸ªå€¼æ˜¯å¦åœ¨ä»»ä½•æƒ…å†µä¸‹åŠŸèƒ½ä¸Šæ˜¯ç›¸åŒçš„ï¼Œæ¯”è¾ƒä¸å¸¸ç”¨ï¼ŒdefineProperty ä½¿ç”¨æ­¤ç®—æ³•ç¡®è®¤é”®æ˜¯å¦å­˜åœ¨ï¼Œä¾‹å¦‚ï¼Œå°†å­˜åœ¨çš„åªè¯»å±æ€§å€¼-0 ä¿®æ”¹ä¸º+0 æ—¶ä¼šæŠ¥é”™ï¼Œå¦‚æœè®¾ç½®ä¸ºåŒæ ·çš„-0 å°†æ‰§è¡Œæ­£å¸¸ï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

```js
function test() {
  'use strict'; // éœ€è¦å¼€å¯ä¸¥æ ¼æ¨¡å¼
  var a = {};

  Object.defineProperty(a, 'a1', {
    value: -0,
    writable: false,
    configurable: false,
    enumerable: false,
  });

  Object.defineProperty(a, 'a1', {
    value: -0,
  }); // æ­£å¸¸æ‰§è¡Œ

  Object.defineProperty(a, 'a1', {
    value: 0,
  }); // Uncaught TypeError: Cannot redefine property: a1
}
test();
```

å¯¹äºæ•°ç»„åˆ¤æ–­æ˜¯å¦å­˜åœ¨çš„åœºæ™¯ï¼Œå¦‚æœæƒ³åŒºåˆ†+0 å’Œ-0ï¼Œå¯ä»¥ä½¿ç”¨ ECMAScript 2015 å¼•å…¥çš„ find æ–¹æ³•ï¼Œè‡ªè¡Œæ§åˆ¶åˆ¤æ–­é€»è¾‘ï¼Œä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

```js
[0].includes(-0); // ä¸èƒ½åŒºåˆ†-0
[0].find((val) => Object.is(val, -0)); // èƒ½åŒºåˆ†+0å’Œ-0
```

## æ€»ç»“

æœ€åæ¥å¯¹æ¯”ä¸‹å››ç§ç®—æ³•çš„åŒºåˆ«ï¼ŒåŒºåˆ«å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š

|                     | éšå¼è½¬æ¢ | NaN å’Œ NaN | +0 å’Œ -0 |
| ------------------- | -------- | ---------- | -------- |
| éä¸¥æ ¼ç›¸ç­‰(==)      | æ˜¯       | false      | true     |
| ä¸¥æ ¼ç›¸ç­‰(===)       | å¦       | false      | true     |
| åŒå€¼é›¶(includes ç­‰) | å¦       | true       | true     |
| åŒå€¼(Object.is)     | å¦       | true       | false    |
